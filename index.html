<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LIVE Token | Premium Staking</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.ethers.io/v6/ethers.umd.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: radial-gradient(circle at top right, #1e293b, #0f172a);
            min-height: 100vh;
        }
        .glass {
            background: rgba(30, 41, 59, 0.7);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .orange-glow {
            box-shadow: 0 0 20px rgba(249, 115, 22, 0.3);
        }
    </style>
</head>
<body class="text-slate-100 antialiased">

    <div class="max-w-4xl mx-auto px-4 py-12">
        <div class="flex flex-col items-center mb-12">
            <img src="token-icon-3d-1.jpg" alt="LIVE Logo" class="w-24 h-24 mb-4 drop-shadow-2xl">
            <h1 class="text-4xl font-extrabold tracking-tight text-white">LIVE <span class="text-orange-500">STAKING</span></h1>
            <p class="text-slate-400 mt-2">Maximize your assets with 100% fixed APY</p>
        </div>

        <div class="grid md:grid-cols-3 gap-6 mb-8">
            <div class="glass p-6 rounded-2xl">
                <p class="text-xs font-semibold text-slate-400 uppercase tracking-wider mb-1">Total Value Locked</p>
                <h3 class="text-2xl font-bold text-orange-400" id="tvl">0.00 LIVE</h3>
            </div>
            <div class="glass p-6 rounded-2xl">
                <p class="text-xs font-semibold text-slate-400 uppercase tracking-wider mb-1">Annual Yield</p>
                <h3 class="text-2xl font-bold text-green-400">100.00%</h3>
            </div>
            <div class="glass p-6 rounded-2xl border-orange-500/30">
                <p class="text-xs font-semibold text-slate-400 uppercase tracking-wider mb-1">Earned Rewards</p>
                <h3 class="text-2xl font-bold text-orange-400" id="rewards text-glow">0.00 LIVE</h3>
            </div>
        </div>

        <div class="glass p-8 rounded-3xl orange-glow">
            <div id="setup-view" class="text-center py-6">
                <h2 class="text-xl font-semibold mb-6">Connect your wallet to start earning</h2>
                <button onclick="connectWallet()" class="bg-orange-600 hover:bg-orange-500 transition-all px-12 py-4 rounded-xl font-bold text-lg shadow-lg hover:scale-105 active:scale-95">
                    Connect MetaMask
                </button>
            </div>

            <div id="staking-view" class="hidden">
                <div class="flex justify-between items-end mb-6">
                    <div>
                        <p class="text-sm text-slate-400">Your Staked Balance</p>
                        <h2 class="text-3xl font-bold" id="userStaked">0.00 LIVE</h2>
                    </div>
                    <div class="text-right">
                        <p class="text-xs text-slate-500" id="userAddress">0x00...000</p>
                    </div>
                </div>

                <div class="bg-slate-800/50 p-6 rounded-2xl mb-6">
                    <label class="block text-sm font-medium text-slate-400 mb-3 text-center uppercase tracking-widest">Stake / Unstake Tokens</label>
                    <input type="number" id="stakeAmount" placeholder="Enter LIVE amount" 
                           class="w-full bg-slate-900 border border-slate-700 rounded-xl px-4 py-4 text-xl font-semibold focus:outline-none focus:border-orange-500 transition-colors mb-4 text-center">
                    
                    <div class="grid grid-cols-2 gap-4">
                        <button onclick="stake()" class="bg-white text-slate-900 hover:bg-slate-200 font-bold py-4 rounded-xl transition-all uppercase tracking-tighter">Stake LIVE</button>
                        <button onclick="unstake()" class="border border-slate-600 hover:bg-slate-800 font-bold py-4 rounded-xl transition-all uppercase tracking-tighter">Unstake</button>
                    </div>
                </div>

                <button onclick="claimRewards()" class="w-full bg-orange-600 hover:bg-orange-500 py-5 rounded-2xl font-black text-xl shadow-xl transition-all hover:scale-[1.01]">
                    CLAIM ALL REWARDS
                </button>
            </div>
        </div>

        <p class="text-center text-slate-500 text-sm mt-8 uppercase tracking-widest font-semibold">Powered by LIVE Network</p>
    </div>

    <script>
        const CONFIG = {
            LIVE_TOKEN: "0xd1119110bbC86EbC0479A2B45F1796Ff9f416cBf",
            STAKING_CONTRACT: "0xbfB68377f62a3Fe6feFAb1e08cD1FAD0EdBca17B",
            CHAIN_ID: 56
        };

        const STAKING_ABI = [
            "function stake(uint256 _amount) external",
            "function unstake(uint256 _amount) external",
            "function claimRewards() public",
            "function calculateRewards(address _user) public view returns (uint256)",
            "function getStakedAmount(address _user) external view returns (uint256)",
            "function getTVL() external view returns (uint256)"
        ];

        const TOKEN_ABI = [
            "function approve(address spender, uint256 amount) external returns (bool)",
            "function balanceOf(address account) external view returns (uint256)"
        ];

        let provider, signer, stakingContract, tokenContract, userAddress;

        async function connectWallet() {
            if (!window.ethereum) return alert("MetaMask not found!");
            try {
                const accounts = await window.ethereum.request({ method: "eth_requestAccounts" });
                userAddress = accounts[0];
                provider = new ethers.BrowserProvider(window.ethereum);
                signer = await provider.getSigner();
                
                stakingContract = new ethers.Contract(CONFIG.STAKING_CONTRACT, STAKING_ABI, signer);
                tokenContract = new ethers.Contract(CONFIG.LIVE_TOKEN, TOKEN_ABI, signer);

                document.getElementById("setup-view").classList.add("hidden");
                document.getElementById("staking-view").classList.remove("hidden");
                document.getElementById("userAddress").innerText = userAddress.substring(0,6) + "..." + userAddress.substring(38);
                
                updateUI();
                setInterval(updateUI, 15000);
            } catch (e) { alert("Connection error: " + e.message); }
        }

        async function updateUI() {
            try {
                const [tvl, rewards, staked] = await Promise.all([
                    stakingContract.getTVL(),
                    stakingContract.calculateRewards(userAddress),
                    stakingContract.getStakedAmount(userAddress)
                ]);
                document.getElementById("tvl").innerText = parseFloat(ethers.formatUnits(tvl, 18)).toFixed(2) + " LIVE";
                document.getElementById("rewards").innerText = parseFloat(ethers.formatUnits(rewards, 18)).toFixed(4) + " LIVE";
                document.getElementById("userStaked").innerText = parseFloat(ethers.formatUnits(staked, 18)).toFixed(2) + " LIVE";
            } catch (e) { console.error(e); }
        }

        async function stake() {
            const amount = document.getElementById("stakeAmount").value;
            if(!amount) return;
            const wei = ethers.parseUnits(amount, 18);
            try {
                const appTx = await tokenContract.approve(CONFIG.STAKING_CONTRACT, wei);
                await appTx.wait();
                const tx = await stakingContract.stake(wei);
                await tx.wait();
                updateUI();
            } catch (e) { alert("Error: " + e.message); }
        }

        async function unstake() {
            const amount = document.getElementById("stakeAmount").value;
            if(!amount) return;
            try {
                const tx = await stakingContract.unstake(ethers.parseUnits(amount, 18));
                await tx.wait();
                updateUI();
            } catch (e) { alert("Error: " + e.message); }
        }

        async function claimRewards() {
            try {
                const tx = await stakingContract.claimRewards();
                await tx.wait();
                updateUI();
            } catch (e) { alert("Error: " + e.message); }
        }
    </script>
</body>
</html>
